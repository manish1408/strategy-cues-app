<div class="property-details" *ngIf="!loading && property">
  <!-- Header Section -->
  <div class="details-nav">
    <div class="container-fluid">
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeTab === 'overview'" (click)="switchTab('overview')">
            <i class="fas fa-chart-line me-2"></i>Overview
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeTab === 'performance'" (click)="switchTab('performance')">
            <i class="fas fa-trending-up me-2"></i>Performance
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeTab === 'platforms'" (click)="switchTab('platforms')">
            <i class="fas fa-globe me-2"></i>Platforms
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" [class.active]="activeTab === 'reviews'" (click)="switchTab('reviews')">
            <i class="fas fa-star me-2"></i>Reviews
          </a>
        </li>
      </ul>
    </div>
  </div>
  
  <div class="details-header">
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-md-8">
          <div class="property-title">
           
            <div class="title-info">
              <button class="btn btn-outline-secondary mb-3" (click)="goBack()">
                <i class="fas fa-arrow-left"></i> Back to Revenue
              </button>
              <h1 class="mb-1">{{ property.Listing_Name }}</h1>
              <div class="property-meta">
                <span class="badge bg-light text-dark me-2">{{ property.Area }}</span>
              </div>
             
            </div>
          </div>
        </div>
        <div class="col-md-4 text-end">
         
          <div class="booking-buttons mt-3">
            <button class="btn btn-booking me-2" (click)="openBookingLink('Booking')" title="Book on Booking.com">
              <i class="fas fa-bed"></i> Booking.com
            </button>
            <button class="btn btn-airbnb me-2" (click)="openBookingLink('Airbnb')" title="Book on Airbnb">
              <i class="fab fa-airbnb"></i> Airbnb
            </button>
            <!-- <button 
              class="btn btn-vrbo" 
              (click)="openBookingLink('VRBO')"
              title="Book on VRBO">
              <i class="fas fa-key"></i> VRBO
            </button> -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Navigation Tabs -->


  <!-- Tab Content -->
  <div class="details-content">
    <div class="container-fluid">

      <!-- Overview Tab -->
      <div *ngIf="activeTab === 'overview'" class="tab-pane">
        <div class="row">
          <!-- Occupancy Section -->
          <div class="col-lg-6 mb-4" *ngIf="property.Occupancy">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>Occupancy Metrics</h5>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-6">
                    <div class="metric-card">
                      <div class="metric-label">This Month</div>
                      <div class="metric-value large">{{ property.Occupancy.TM ? property.Occupancy.TM + '%' : 'N/A' }}</div>
                      
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="metric-card">
                      <div class="metric-label">Next Month</div>
                      <div class="metric-value large">{{ property.Occupancy.NM ? property.Occupancy.NM + '%' : 'N/A' }}</div>
                     
                    </div>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-6">
                    <div class="metric-card small">
                      <div class="metric-label">7 Days</div>
                      <div class="metric-value">{{ property.Occupancy['7_days'] ? property.Occupancy['7_days'] + '%' : 'N/A' }}</div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="metric-card small">
                      <div class="metric-label">30 Days</div>
                      <div class="metric-value">{{ property.Occupancy['30_days'] ? property.Occupancy['30_days'] + '%' : 'N/A' }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Revenue Section -->
          <div class="col-lg-6 mb-4" *ngIf="property.ADR || property.RevPAR">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-dollar-sign me-2"></i>Revenue Metrics</h5>
              </div>
              <div class="card-body">
                <div class="row" *ngIf="property.ADR">
                  <div class="col-6">
                    <div class="metric-card">
                      <div class="metric-label">Rental Average Day Rate (This Month)</div>
                      <div class="metric-value large">{{ property.ADR.TM ? property.ADR.TM + '%' : 'N/A' }}</div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="metric-card">
                      <div class="metric-label">Rental Average Day Rate (Next Month)</div>
                      <div class="metric-value large">{{ property.ADR.NM ? property.ADR.NM + '%' : 'N/A' }}</div>
                    </div>
                  </div>
                </div>
                <div class="row mt-3" *ngIf="property.RevPAR">
                  <div class="col-6">
                    <div class="metric-card">
                      <div class="metric-label">RevPAR (This Month)</div>
                      <div class="metric-value large">{{ property.RevPAR.TM ? property.RevPAR.TM : 'N/A' }}</div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="metric-card">
                      <div class="metric-label">RevPAR (Next Month)</div>
                      <div class="metric-value large">{{ property.RevPAR.NM ? property.RevPAR.NM  : 'N/A' }}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Pick Up Occupancy -->
        <div class="row" *ngIf="property.Pick_Up_Occ || property.MPI !== null || property.Min_Rate_Threshold !== null">
          <div class="col-12 mb-4">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Pick Up Occupancy</h5>
              </div>
              <div class="card-body">
                <div class="row" *ngIf="property.Pick_Up_Occ">
                  <div class="col-md-4">
                    <div class="metric-card">
                      <div class="metric-label">7 Days</div>
                      <div class="metric-value">{{ property.Pick_Up_Occ['7_Days'] ? property.Pick_Up_Occ['7_Days'] + '%' : 'N/A' }}</div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="metric-card">
                      <div class="metric-label">14 Days</div>
                      <div class="metric-value">{{ property.Pick_Up_Occ['14_Days'] ? property.Pick_Up_Occ['14_Days'] + '%' : 'N/A' }}</div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="metric-card">
                      <div class="metric-label">30 Days</div>
                      <div class="metric-value">{{ property.Pick_Up_Occ['30_Days'] ? property.Pick_Up_Occ['30_Days'] + '%' : 'N/A' }}</div>
                    </div>
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-md-6" *ngIf="property.MPI !== null">
                    <div class="metric-card">
                      <div class="metric-label text-center mb-3">Market Penetration Index</div>
                      <div class="row">
                        <div class="col-md-4 text-center">
                          <div class="metric-sub-label">(This Month)</div>
                          <div class="metric-value">{{ property.MPI.TM ? property.MPI.TM + '%' : 'N/A' }}</div>
                        </div>
                        <div class="col-md-4 text-center">
                          <div class="metric-sub-label">(Next Month)</div>
                          <div class="metric-value">{{ property.MPI.NM ? property.MPI.NM + '%' : 'N/A' }}</div>
                        </div>
                        <div class="col-md-4 text-center">
                          <div class="metric-sub-label">(Last Year This Month)</div>
                          <div class="metric-value">{{ property.MPI.LYTM ? property.MPI.LYTM + '%' : 'N/A' }}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6" *ngIf="property.Min_Rate_Threshold !== null">
                    <div class="metric-card">
                      <div class="metric-label">Min Rate Threshold</div>
                      <div class="metric-value large">{{ property.Min_Rate_Threshold || 'N/A' }}</div>
                    </div>
                  </div>

                </div>

              </div>
            </div>
          </div>
        </div>

        <!-- Photos Section -->
        <div class="row" *ngIf="property.Photos">
          <div class="col-12 mb-4">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-images me-2"></i>Property Photos</h5>
              </div>
              <div class="card-body">
                <div class="row">
                  <!-- Booking.com Photos -->
                  <div class="col-md-6 mb-3" *ngIf="property.Photos.booking && property.Photos.booking.length > 0">
                    <h6><i class="fas fa-bed me-2"></i>Booking.com Photos ({{ property.Photos.booking.length }})</h6>
                    <div class="photo-grid">
                      <div class="photo-item" *ngFor="let photo of property.Photos.booking.slice(0, 6)">
                        <img [src]="photo.url || placeholderImage" 
                             [alt]="photo.accessibility_label || 'Property photo'" 
                             class="img-fluid rounded" 
                             (click)="openPhotoModal(photo.url, photo.accessibility_label)"
                             (error)="onImageError($event)"
                             loading="lazy">
                      </div>
                    </div>
                    <small class="text-muted" *ngIf="property.Photos.booking.length > 6">
                      Showing first 6 of {{ property.Photos.booking.length }} photos
                    </small>
                  </div>
                  
                  <!-- Booking.com Photos Placeholder -->
                  <div class="col-md-6 mb-3" *ngIf="!property.Photos.booking || property.Photos.booking.length === 0">
                    <h6><i class="fas fa-bed me-2"></i>Booking.com Photos</h6>
                    <div class="photo-grid">
                      <div class="photo-item">
                        <img [src]="placeholderImage" 
                             alt="No Booking.com photos available" 
                             class="img-fluid rounded placeholder-image">
                      </div>
                    </div>
                    <small class="text-muted">No Booking.com photos available</small>
                  </div>
                  
                  <!-- Airbnb Photos -->
                  <div class="col-md-6 mb-3" *ngIf="property.Photos.airbnb && property.Photos.airbnb.length > 0">
                    <h6><i class="fab fa-airbnb me-2"></i>Airbnb Photos ({{ property.Photos.airbnb.length }})</h6>
                    <div class="photo-grid">
                      <div class="photo-item" *ngFor="let photo of property.Photos.airbnb.slice(0, 6)">
                        <img [src]="photo.url || placeholderImage" 
                             [alt]="photo.accessibility_label || 'Property photo'" 
                             class="img-fluid rounded" 
                             (click)="openPhotoModal(photo.url, photo.accessibility_label)"
                             (error)="onImageError($event)"
                             loading="lazy">
                      </div>
                    </div>
                    <small class="text-muted" *ngIf="property.Photos.airbnb.length > 6">
                      Showing first 6 of {{ property.Photos.airbnb.length }} photos
                    </small>
                  </div>
                  
                  <!-- Airbnb Photos Placeholder -->
                  <div class="col-md-6 mb-3" *ngIf="!property.Photos.airbnb || property.Photos.airbnb.length === 0">
                    <h6><i class="fab fa-airbnb me-2"></i>Airbnb Photos</h6>
                    <div class="photo-grid">
                      <div class="photo-item">
                        <img [src]="placeholderImage" 
                             alt="No Airbnb photos available" 
                             class="img-fluid rounded placeholder-image">
                      </div>
                    </div>
                    <small class="text-muted">No Airbnb photos available</small>
                  </div>
                </div>
                
                <!-- No Photos Message - Only show if no Photos object at all -->
                <div class="text-center py-3" *ngIf="!property.Photos">
                  <i class="fas fa-image fa-2x text-muted mb-2"></i>
                  <p class="text-muted mb-0">No photos available for this property</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Data Available Message -->
        <div class="row"
          *ngIf="!property.Occupancy && !property.ADR && !property.RevPAR && property.MPI === null && property.Min_Rate_Threshold === null && !property.Pick_Up_Occ && !property.Photos">
          <div class="col-12">
            <div class="card">
              <div class="card-body text-center py-5">
                <i class="fas fa-info-circle fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No Overview Data Available</h4>
                <p class="text-muted">This property doesn't have any overview metrics data at the moment.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Performance Tab -->
      <div *ngIf="activeTab === 'performance'" class="tab-pane">
        <div class="row" *ngIf="property.STLY_Var">
          <div class="col-lg-6 mb-4" *ngIf="property.STLY_Var">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-calendar-check me-2"></i>Same Time Last Year (STLY)</h5>
              </div>
              <div class="card-body">
                <div class="performance-metric">
                  <div class="metric-row">
                    <span class="metric-name">Occupancy</span>
                    <span class="metric-value" [ngClass]="getPerformanceClass(property.STLY_Var.Occ)">
                      {{ property.STLY_Var.Occ ? property.STLY_Var.Occ + '%' : 'N/A' }}
                    </span>
                  </div>
                  <div class="metric-row">
                    <span class="metric-name">ADR</span>
                    <span class="metric-value" [ngClass]="getPerformanceClass(property.STLY_Var.ADR)">
                      {{ property.STLY_Var.ADR ? property.STLY_Var.ADR + '%' : 'N/A' }}
                    </span>
                  </div>
                  <div class="metric-row">
                    <span class="metric-name">RevPAR</span>
                    <span class="metric-value" [ngClass]="getPerformanceClass(property.STLY_Var.RevPAR)">
                      {{ property.STLY_Var.RevPAR ? property.STLY_Var.RevPAR + '%' : 'N/A' }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-6 mb-4" *ngIf="property.STLM_Var">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-calendar-minus me-2"></i>Last month Actuals</h5>
              </div>
              <div class="card-body">
                <div class="performance-metric">
                  <div class="metric-row">
                    <span class="metric-name">Occupancy</span>
                    <span class="metric-value">
                      {{ property.STLM_Var.Occ ? property.STLM_Var.Occ + '%' : 'N/A' }}
                    </span>
                  </div>
                  <div class="metric-row">
                    <span class="metric-name">ADR</span>
                    <span class="metric-value">
                      {{ property.STLM_Var.ADR ? property.STLM_Var.ADR  : 'N/A' }}
                    </span>
                  </div>
                  <div class="metric-row">
                    <span class="metric-name">RevPAR</span>
                    <span class="metric-value">
                        {{ property.STLM_Var.RevPAR ? property.STLM_Var.RevPAR  : 'N/A' }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- No Performance Data Available Message -->
        <div class="row" *ngIf="!property.STLY_Var && !property.STLM_Var">
          <div class="col-12">
            <div class="card">
              <div class="card-body text-center py-5">
                <i class="fas fa-chart-line fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No Performance Data Available</h4>
                <p class="text-muted">This property doesn't have any performance comparison data at the moment.</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Platforms Tab -->
      <div *ngIf="activeTab === 'platforms'" class="tab-pane">
        <div class="row" *ngIf="property.BookingCom || property.Airbnb">
          <!-- Booking.com -->
          <div class="col-lg-4 mb-4" *ngIf="property.BookingCom">
            <div class="card platform-card">
              <div class="card-header text-white">
                <h5 class="mb-0"><i class="fas fa-bed me-2"></i>Booking.com</h5>
              </div>
              <div class="card-body">
                <div class="platform-features">
                  <div class="feature-item">
                    <span class="feature-name">Genius Program</span>
                    <span class="feature-status" *ngIf="property.BookingCom.Genius !== null"
                      [ngClass]="isFeatureEnabled(property.BookingCom.Genius) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.BookingCom.Genius) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.BookingCom.Genius }}
                    </span>
                    <span class="feature-status" *ngIf="property.BookingCom.Genius === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-name">Mobile Discount</span>
                    <span class="feature-status" *ngIf="property.BookingCom.Mobile !== null"
                      [ngClass]="isFeatureEnabled(property.BookingCom.Mobile) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.BookingCom.Mobile) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.BookingCom.Mobile }}
                    </span>
                    <span class="feature-status" *ngIf="property.BookingCom.Mobile === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-name">Preferred Partner</span>
                    <span class="feature-status" *ngIf="property.BookingCom.Pref !== null"
                      [ngClass]="isFeatureEnabled(property.BookingCom.Pref) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.BookingCom.Pref) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.BookingCom.Pref }}
                    </span>
                    <span class="feature-status" *ngIf="property.BookingCom.Pref === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-name">Weekly Discount</span>
                    <span class="feature-status" *ngIf="property.BookingCom.Weekly !== null"
                      [ngClass]="isFeatureEnabled(property.BookingCom.Weekly) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.BookingCom.Weekly) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.BookingCom.Weekly }}
                    </span>
                    <span class="feature-status" *ngIf="property.BookingCom.Weekly === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-name">Monthly Discount</span>
                    <span class="feature-status" *ngIf="property.BookingCom.Monthly !== null"
                      [ngClass]="isFeatureEnabled(property.BookingCom.Monthly) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.BookingCom.Monthly) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.BookingCom.Monthly }}
                    </span>
                    <span class="feature-status" *ngIf="property.BookingCom.Monthly === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-name">Last Minute Discount</span>
                    <span class="feature-status" *ngIf="property.BookingCom.LM_Disc !== null"
                      [ngClass]="isFeatureEnabled(property.BookingCom.LM_Disc) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.BookingCom.LM_Disc) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.BookingCom.LM_Disc }}
                    </span>
                    <span class="feature-status" *ngIf="property.BookingCom.LM_Disc === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Airbnb -->
          <div class="col-lg-4 mb-4" *ngIf="property.Airbnb">
            <div class="card platform-card">
              <div class="card-header bg-danger text-white">
                <h5 class="mb-0"><i class="fab fa-airbnb me-2"></i>Airbnb</h5>
              </div>
              <div class="card-body">
                <div class="platform-features">
                  <div class="feature-item">
                    <span class="feature-name">Weekly Discount</span>
                    <span class="feature-status" *ngIf="property.Airbnb.Weekly !== null" [ngClass]="'enabled'">
                      {{ property.Airbnb.Weekly }}%
                    </span>
                    <span class="feature-status" *ngIf="property.Airbnb.Weekly === null" style="color: #ccc;">
                      -
                    </span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-name">Monthly Discount</span>
                    <span class="feature-status" *ngIf="property.Airbnb.Monthly !== null" [ngClass]="'enabled'">
                      {{ property.Airbnb.Monthly }}%
                    </span>
                    <span class="feature-status" *ngIf="property.Airbnb.Monthly === null" style="color: #ccc;">
                      -
                    </span>
                  </div>
                  <!-- <div class="feature-item">
                    <span class="feature-name">Member Discount</span>
                    <span class="feature-status" *ngIf="property.Airbnb.Member !== null" [ngClass]="'enabled'">
                      <i class="fas fa-check-circle"></i>
                      {{ property.Airbnb.Member }}
                    </span>
                    <span class="feature-status" *ngIf="property.Airbnb.Member === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div> -->
                  <div class="feature-item">
                    <span class="feature-name">Last Minute Discount</span>
                    <span class="feature-status" *ngIf="property.Airbnb.LM_Disc !== null" [ngClass]="'enabled'">
                      <span *ngIf="isObject(property.Airbnb.LM_Disc)">
                        {{ property.Airbnb.LM_Disc.leadDays }} days, {{ property.Airbnb.LM_Disc.priceChange }}% off
                      </span>
                      <span *ngIf="!isObject(property.Airbnb.LM_Disc)">
                        {{ property.Airbnb.LM_Disc }}
                      </span>
                    </span>
                    <span class="feature-status" *ngIf="property.Airbnb.LM_Disc === null" style="color: #ccc;">
                      -
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- VRBO -->
          <!-- <div class="col-lg-4 mb-4" *ngIf="property.VRBO">
            <div class="card platform-card">
              <div class="card-header bg-warning text-dark">
                <h5 class="mb-0"><i class="fas fa-building me-2"></i>VRBO</h5>
              </div>
              <div class="card-body">
                <div class="platform-features">
                  <div class="feature-item">
                    <span class="feature-name">Weekly Discount</span>
                    <span class="feature-status" *ngIf="property.VRBO.Weekly !== null"
                      [ngClass]="isFeatureEnabled(property.VRBO.Weekly) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.VRBO.Weekly) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.VRBO.Weekly }}
                    </span>
                    <span class="feature-status" *ngIf="property.VRBO.Weekly === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                  <div class="feature-item">
                    <span class="feature-name">Monthly Discount</span>
                    <span class="feature-status" *ngIf="property.VRBO.Monthly !== null"
                      [ngClass]="isFeatureEnabled(property.VRBO.Monthly) ? 'enabled' : 'disabled'">
                      <i class="fas"
                        [ngClass]="isFeatureEnabled(property.VRBO.Monthly) ? 'fa-check-circle' : 'fa-times-circle'"></i>
                      {{ property.VRBO.Monthly }}
                    </span>
                    <span class="feature-status" *ngIf="property.VRBO.Monthly === null" style="color: #ccc;">
                      <i class="fas fa-minus-circle"></i>
                      -
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </div> -->
        </div>

        <!-- No Platform Data Available Message -->
        <div class="row" *ngIf="!property.BookingCom && !property.Airbnb">
          <div class="col-12">
            <div class="card">
              <div class="card-body text-center py-5">
                <i class="fas fa-globe fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No Platform Data Available</h4>
                <p class="text-muted">This property doesn't have any platform configuration data at the moment.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Cancellation Policies -->
        <div class="row" *ngIf="hasCancellationPolicies() || hasGuestConfig()">
          <div class="col-12 mb-4">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-shield-alt me-2"></i>Cancellation Policies & Configuration</h5>
              </div>
              <div class="card-body">
                <!-- Cancellation Policies Section -->
                <div *ngIf="hasCancellationPolicies()" class="mb-4">
                  <h6 class="mb-3"><i class="fas fa-list-alt me-2"></i>Cancellation Policies</h6>
                  <div class="row">
                    <!-- Booking.com Policies -->
                    <div *ngIf="property.CXL_Policy.Booking && property.CXL_Policy.Booking.length > 0" class="col-12 mb-3">
                      <div class="policy-platform-card">
                        <div class="policy-platform-header">
                          <span class="platform-name">
                            <i class="fas fa-bed me-1"></i>
                            Booking.com
                          </span>
                        </div>
                        <div class="row">
                          <div class="col-md-6 col-lg-4 mb-3" *ngFor="let policy of property.CXL_Policy.Booking">
                            <div class="policy-card">
                              <div class="policy-header">
                                <span class="policy-type badge badge-primary">
                                  {{ policy.ratePlanName }}
                                </span>
                              </div>
                              <div class="policy-description">
                                <small>
                                  {{ policy.policyInfo.cancellation_desc }} 
                                </small>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Airbnb Policy -->
                    <div *ngIf="property.CXL_Policy.Airbnb" class="col-md-6 col-lg-4 mb-3">
                      <div class="policy-card">
                        <div class="policy-platform-header">
                          <span class="platform-name">
                            <i class="fab fa-airbnb me-1"></i>
                            Airbnb
                          </span>
                        </div>
                        <div class="policy-header">
                          <span class="policy-type badge badge-success">
                            {{ property.CXL_Policy.Airbnb.type }}
                          </span>
                        </div>
                        <div class="policy-description">
                          {{ property.CXL_Policy.Airbnb.description }}
                        </div>
                      </div>
                    </div>

                    <!-- VRBO Policy -->
                    <div *ngIf="property.CXL_Policy.VRBO" class="col-md-6 col-lg-4 mb-3">
                      <div class="policy-card">
                        <div class="policy-platform-header">
                          <span class="platform-name">
                            <i class="fas fa-home me-1"></i>
                            VRBO
                          </span>
                        </div>
                        <div class="policy-header">
                          <span class="policy-type badge badge-info">
                            {{ property.CXL_Policy.VRBO.type }}
                          </span>
                        </div>
                        <div class="policy-description">
                          {{ property.CXL_Policy.VRBO.description }}
                        </div>
                      </div>
                    </div>

                    <!-- Pricelabs Policy (Future) -->
                    <div *ngIf="property.CXL_Policy.Pricelabs" class="col-md-6 col-lg-4 mb-3">
                      <div class="policy-card">
                        <div class="policy-platform-header">
                          <span class="platform-name">
                            <i class="fas fa-chart-line me-1"></i>
                            Pricelabs
                          </span>
                        </div>
                        <div class="policy-header">
                          <span class="policy-type badge badge-warning">
                            {{ property.CXL_Policy.Pricelabs.type }}
                          </span>
                        </div>
                        <div class="policy-description">
                          {{ property.CXL_Policy.Pricelabs.description }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Guest Configuration Section -->
                <div *ngIf="hasGuestConfig()" class="guest-config-section">
                  <h6 class="mb-3"><i class="fas fa-users me-2"></i>Guest Configuration</h6>
                  <div class="row">
                    <!-- Booking.com Guest Config -->
                    <div class="col-md-6 col-lg-4 mb-3" *ngIf="property.Adult_Child_Config.Booking">
                      <div class="guest-config-card">
                        <div class="guest-config-header">
                          <i class="fas fa-bed me-2"></i>
                          <strong>Booking.com</strong>
                        </div>
                        <div class="guest-config-content">
                          <div class="guest-details">
                            <div class="guest-item">
                              <i class="fas fa-users me-2"></i>
                              <strong>Max Guests:</strong> {{ property.Adult_Child_Config.Booking.max_guests }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-user me-2"></i>
                              <strong>Max Adults:</strong> {{ property.Adult_Child_Config.Booking.max_adults }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-child me-2"></i>
                              <strong>Max Children:</strong> {{ property.Adult_Child_Config.Booking.max_children }}
                            </div>
                            <div class="guest-item" *ngIf="property.Adult_Child_Config.Booking.max_infants">
                              <i class="fas fa-baby me-2"></i>
                              <strong>Max Infants:</strong> {{ property.Adult_Child_Config.Booking.max_infants }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-door-open me-2"></i>
                              <strong>Room Count:</strong> {{ property.Adult_Child_Config.Booking.room_count }}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Airbnb Guest Config -->
                    <div class="col-md-6 col-lg-4 mb-3" *ngIf="property.Adult_Child_Config.Airbnb">
                      <div class="guest-config-card">
                        <div class="guest-config-header">
                          <i class="fab fa-airbnb me-2"></i>
                          <strong>Airbnb</strong>
                        </div>
                        <div class="guest-config-content">
                          <div class="guest-details">
                            <div class="guest-item">
                              <i class="fas fa-users me-2"></i>
                              <strong>Max Guests:</strong> {{ property.Adult_Child_Config.Airbnb.max_guests }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-user me-2"></i>
                              <strong>Max Adults:</strong> {{ property.Adult_Child_Config.Airbnb.max_adults }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-child me-2"></i>
                              <strong>Max Children:</strong> {{ property.Adult_Child_Config.Airbnb.max_children }}
                            </div>
                            <div class="guest-item" *ngIf="property.Adult_Child_Config.Airbnb.max_infants">
                              <i class="fas fa-baby me-2"></i>
                              <strong>Max Infants:</strong> {{ property.Adult_Child_Config.Airbnb.max_infants }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-door-open me-2"></i>
                              <strong>Room Count:</strong> {{ property.Adult_Child_Config.Airbnb.room_count }}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- VRBO Guest Config -->
                    <div class="col-md-6 col-lg-4 mb-3" *ngIf="property.Adult_Child_Config.VRBO">
                      <div class="guest-config-card">
                        <div class="guest-config-header">
                          <i class="fas fa-home me-2"></i>
                          <strong>VRBO</strong>
                        </div>
                        <div class="guest-config-content">
                          <div class="guest-details">
                            <div class="guest-item">
                              <i class="fas fa-users me-2"></i>
                              <strong>Max Guests:</strong> {{ property.Adult_Child_Config.VRBO.max_guests }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-user me-2"></i>
                              <strong>Max Adults:</strong> {{ property.Adult_Child_Config.VRBO.max_adults }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-child me-2"></i>
                              <strong>Max Children:</strong> {{ property.Adult_Child_Config.VRBO.max_children }}
                            </div>
                            <div class="guest-item" *ngIf="property.Adult_Child_Config.VRBO.max_infants">
                              <i class="fas fa-baby me-2"></i>
                              <strong>Max Infants:</strong> {{ property.Adult_Child_Config.VRBO.max_infants }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-door-open me-2"></i>
                              <strong>Room Count:</strong> {{ property.Adult_Child_Config.VRBO.room_count }}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Pricelabs Guest Config (Future) -->
                    <div class="col-md-6 col-lg-4 mb-3" *ngIf="property.Adult_Child_Config.Pricelabs">
                      <div class="guest-config-card">
                        <div class="guest-config-header">
                          <i class="fas fa-chart-line me-2"></i>
                          <strong>Pricelabs</strong>
                        </div>
                        <div class="guest-config-content">
                          <div class="guest-details">
                            <div class="guest-item">
                              <i class="fas fa-users me-2"></i>
                              <strong>Max Guests:</strong> {{ property.Adult_Child_Config.Pricelabs.max_guests }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-user me-2"></i>
                              <strong>Max Adults:</strong> {{ property.Adult_Child_Config.Pricelabs.max_adults }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-child me-2"></i>
                              <strong>Max Children:</strong> {{ property.Adult_Child_Config.Pricelabs.max_children }}
                            </div>
                            <div class="guest-item" *ngIf="property.Adult_Child_Config.Pricelabs.max_infants">
                              <i class="fas fa-baby me-2"></i>
                              <strong>Max Infants:</strong> {{ property.Adult_Child_Config.Pricelabs.max_infants }}
                            </div>
                            <div class="guest-item">
                              <i class="fas fa-door-open me-2"></i>
                              <strong>Room Count:</strong> {{ property.Adult_Child_Config.Pricelabs.room_count }}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Reviews Tab -->
      <div *ngIf="activeTab === 'reviews'" class="tab-pane">
        <div class="row" *ngIf="property.Reviews">
          <!-- Booking.com Reviews -->
          <div class="col-lg-4 mb-4" *ngIf="property.Reviews.Booking">
            <div class="card review-card">
              <div class="card-header text-white">
                <h5 class="mb-0"><i class="fas fa-bed me-2"></i>Booking.com Reviews</h5>
              </div>
              <div class="card-body">
                <div class="review-summary">
                  <div class="score-display">
                    <span class="score-value" [ngClass]="getReviewScoreClass(property.Reviews.Booking.Rev_Score)">
                      {{ property.Reviews.Booking.Rev_Score || 'N/A' }}
                    </span>
                    <div class="score-stars" *ngIf="property.Reviews.Booking.Rev_Score">
                      <i class="fas fa-star" *ngFor="let star of [1,2,3,4,5]; let i = index"
                        [ngClass]="i < Math.floor(+property.Reviews.Booking.Rev_Score) ? 'text-warning' : 'text-muted'"></i>
                    </div>
                  </div>
                  <div class="review-details">
                    <div class="detail-item">
                      <span class="label">Total Reviews:</span>
                      <span class="value">{{ property.Reviews.Booking.Total_Rev || 'N/A' }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="label">Last Review Date:</span>
                      <span class="value">{{ property.Reviews.Booking.Last_Rev_Dt || 'N/A' }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="label">Last Review Score:</span>
                      <span class="value">{{ property.Reviews.Booking.Last_Rev_Score || 'N/A' }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Airbnb Reviews -->
          <div class="col-lg-4 mb-4" *ngIf="property.Reviews.Airbnb">
            <div class="card review-card">
              <div class="card-header bg-danger text-white">
                <h5 class="mb-0"><i class="fab fa-airbnb me-2"></i>Airbnb Reviews</h5>
              </div>
              <div class="card-body">
                <div class="review-summary">
                  <div class="score-display">
                    <span class="score-value" [ngClass]="getReviewScoreClass(property.Reviews.Airbnb.Rev_Score)">
                      {{ property.Reviews.Airbnb.Rev_Score || 'N/A' }}
                    </span>
                    <div class="score-stars" *ngIf="property.Reviews.Airbnb.Rev_Score">
                      <i class="fas fa-star" *ngFor="let star of [1,2,3,4,5]; let i = index"
                        [ngClass]="i < Math.floor(+property.Reviews.Airbnb.Rev_Score) ? 'text-warning' : 'text-muted'"></i>
                    </div>
                  </div>
                  <div class="review-details">
                    <div class="detail-item">
                      <span class="label">Total Reviews:</span>
                      <span class="value">{{ property.Reviews.Airbnb.Total_Rev || 'N/A' }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="label">Last Review Date:</span>
                      <span class="value">{{ property.Reviews.Airbnb.Last_Rev_Dt || 'N/A' }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="label">Last Review Score:</span>
                      <span class="value">{{ property.Reviews.Airbnb.Last_Rev_Score || 'N/A' }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- VRBO Reviews -->
          <!-- <div class="col-lg-4 mb-4" *ngIf="property.Reviews.VRBO">
            <div class="card review-card">
              <div class="card-header bg-warning text-dark">
                <h5 class="mb-0"><i class="fas fa-building me-2"></i>VRBO Reviews</h5>
              </div>
              <div class="card-body">
                <div class="review-summary">
                  <div class="score-display">
                    <span class="score-value" [ngClass]="getReviewScoreClass(property.Reviews.VRBO.Rev_Score)">
                      {{ property.Reviews.VRBO.Rev_Score || 'N/A' }}
                    </span>
                    <div class="score-stars" *ngIf="property.Reviews.VRBO.Rev_Score">
                      <i class="fas fa-star" *ngFor="let star of [1,2,3,4,5]; let i = index"
                        [ngClass]="i < Math.floor(+property.Reviews.VRBO.Rev_Score) ? 'text-warning' : 'text-muted'"></i>
                    </div>
                  </div>
                  <div class="review-details">
                    <div class="detail-item">
                      <span class="label">Total Reviews:</span>
                      <span class="value">{{ property.Reviews.VRBO.Total_Rev || 'N/A' }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="label">Last Review Date:</span>
                      <span class="value">{{ property.Reviews.VRBO.Last_Rev_Dt || 'N/A' }}</span>
                    </div>
                    <div class="detail-item">
                      <span class="label">Last Review Score:</span>
                      <span class="value">{{ property.Reviews.VRBO.Last_Rev_Score || 'N/A' }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div> -->
        </div>

        <!-- No Reviews Data Available Message -->
        <div class="row" *ngIf="!property.Reviews">
          <div class="col-12">
            <div class="card">
              <div class="card-body text-center py-5">
                <i class="fas fa-star fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No Reviews Data Available</h4>
                <p class="text-muted">This property doesn't have any reviews data at the moment.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Loading State -->
<div *ngIf="loading" class="property-loading">
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-md-6 text-center">
        <div class="card">
          <div class="card-body py-5 loading-state">
            <div class="spinner-border mb-3" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <h3>Loading Property Details</h3>
            <p class="text-muted mb-4">Please wait while we fetch the property information...</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Property Not Found -->
<div *ngIf="!loading && !property && error" class="property-not-found">
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-md-6 text-center">
        <div class="card">
          <div class="card-body py-5">
            <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
            <h3>Property Not Found</h3>
            <p class="text-muted mb-4">{{ error }}</p>
            <button class="btn btn-primary" (click)="goBack()">
              <i class="fas fa-arrow-left me-2"></i>Back to Revenue Dashboard
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>